socket = import socket

avail = socket.tls_available()
if type(avail) != "boolean"
  error("socket.tls_available() must return bool")

s = socket.tcp()
if s == nil
  error("socket.tcp() returned nil")

r = s.tls(s)
if r != true and type(r) != "string"
  error("socket.tls() should return true or error string")

s.close(s)

print "socket tls api ok"
