fn assert_true(cond, msg = nil)
  if not cond
    error("assert_true failed")

fn assert_eq(actual, expected, msg = nil)
  if actual != expected
    error("assert_eq failed")

-- literals and variables
n = 42
s = "hello"
b = true
z = nil
arr2 = 1, 2, 3
assert_eq(n, 42)
assert_eq(s, "hello")
assert_true(b)
assert_true(z == nil)
assert_eq(arr2[1], 1)
assert_eq(arr2[3], 3)
assert_eq(min(3, 1, 2), 1)
assert_eq(max(3, 1, 2), 3)
assert_eq(sum(1, 2, 3), 6)
assert_eq(sum({1, 2, 3, 4}), 10)

-- if / elif / else
v = 0
if n < 0
  v = -1
elif n == 42
  v = 1
else
  v = 2
assert_eq(v, 1)

-- while loop
w = 0
i = 1
while i <= 5
  w = w + i
  i = i + 1
assert_eq(w, 15)

-- for range
r = 0
for j in 1..4
  r = r + j
assert_eq(r, 10)

-- tables, access, length
t = {a = 1}
t.b = 2
t["c"] = 3
nh = {1, 2, 3, [10] = "hello"}
assert_eq(t.a, 1)
assert_eq(t.b, 2)
assert_eq(t["c"], 3)
assert_eq(nh[10], "hello")
arr = {10, 20, 30}
assert_eq(#arr, 3)
assert_eq(arr[-1], 30)
assert_eq(arr[-2], 20)
assert_eq(#"abc", 3)
