from lib.test import assert_eq

io = import io
os = import os

path = "tests/tmp_io_iter.txt"
f = io.open(path, "w")
f.write("line1\nline2\nXYZ")
f.close()

r = io.open(path, "r")
file_lines = {}
for line in r
  file_lines <+ line
r.close()

assert_eq(#file_lines, 3)
assert_eq(file_lines[1], "line1")
assert_eq(file_lines[2], "line2")
assert_eq(file_lines[3], "XYZ")

buf = io.buffer("p\nq\nr")
buf_lines = {}
for line in buf
  buf_lines <+ line
buf.close()

assert_eq(#buf_lines, 3)
assert_eq(buf_lines[1], "p")
assert_eq(buf_lines[2], "q")
assert_eq(buf_lines[3], "r")

os.remove(path)
print "io iterators ok"
