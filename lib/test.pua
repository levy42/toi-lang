import os

fn assert_true(cond, msg = nil)
  if not cond
    error(msg == nil ? "assert_true failed" : msg)

fn assert_eq(actual, expected, msg = nil)
  if actual != expected
    error(msg == nil ? "assert_eq failed" : msg)

fn expect_error(fn_)
  msg = nil
  try
    fn_()
  except e
    msg = e
  if msg == nil
    error("expect_error failed")
  return msg



TimeIt = {
  _startime = 0
  msg = ""
  echo = false

  __enter = fn(self)
    self._startime = os.clock()
    if self.echo print f"-- Started {self.msg}"

  __exit = fn(self, ex)
    elapsed = os.clock() - self._startime
    if self.echo print f"-- {self.msg} finished in {self.elapsed}s"
}
TimeIt.__index = TimeIt

fn timeit(msg = "timer", echo=false)
  return TimeIt {msg=msg, _startime = 0, echo=echo}

return {
  assert_true = assert_true,
  assert_eq = assert_eq,
  expect_error = expect_error,
  timeit = timeit,
  TimeIt = TimeIt,
}
